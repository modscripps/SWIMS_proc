function [ft_dr,fs_dr,Rr_dr]= DRFlux(t1,t2,s1,s2,p)function [ft_dr,fs_dr,Rr_dr]= DRFlux(t1,t2,s1,s2,p)%Compute the heat and salt fluxes in a DR step, given t1,t2,s1,s2 and p.%s in psu, t in degs C, p in MPa.  It computes in situ alpha and beta,%and returns the density ratio of the interface as well as the fluxes%according to Huppert 1971, in m ¡C/sec and m psu/sec.  Note ft%times 100 yields the heat flux in cal/cm^2/sec, for rho=1 g/cm^3. %Compute alpha and betabeta=sw_beta(s1,t1,p*100)alpha=sw_alpha(s1,t1,p*100)g=9.8;nu=1e-6;K=1.4e-7;Ks=K/80;dt=t2-t1;ds=s2-s1;Rr_dr=alpha*dt/beta/ds;ft_dr=0.32*K.^(2/3)*(alpha*g/nu).^(1/3)*dt.^(4/3)./(beta*ds/alpha/dt).^2;if Rr_dr > 1/2	fs_dr=alpha/beta*(1.85-0.85*beta*ds/alpha/dt).*ft_dr;	%Rrho between 1/2 and 1elseif Rr_dr <= 1/2	fs_dr=0.15*alpha/beta*ft_dr;	%Rrho < 1/2else	disp 'error: not DR R_r'end
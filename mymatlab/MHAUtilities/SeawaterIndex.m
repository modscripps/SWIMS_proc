function n=SeawaterIndex(P,S,T,lam)%The index of refraction of seawater according to Quan and Fry, %Applied Optics 34:18., 1995, 3477-3480.  It is an empirical fit to %The data of Austin and Halikas 1976, which had experimental errors%of 3e-5.  The stated accuracy of the equation is < 5e-5.%Their equation is for atmospheric pressure, and I've added a dependence%of pressure of 1.37e-6P to this as they state is valid up to 100 m.%P is pressure in decibars (0=atmos.),%S the salinity in ppt, %T is temperature in degs C, and%lam is the wavelength in nanometers.  Default = 1310.%Check value: SeawaterIndex(P=0,S=34.998,T=1,lam=700) = 1.33787.%CAUTION extrapolating to 1310 nm is a stretch since the data only span %400-700 nm!if ~exist('lam')	lam=1310;endno=1.31405;n1=1.779e-4;n2=-1.05e-6;n3=1.6e-8;n4=-2.02e-6;n5=15.868;n6=0.01155;n7=-0.00423;n8=-4382;n9=1.1455e6;np=1.37e-6;n=no+(n1+n2*T+n3*T.^2).*S + n4*T.^2 ... + 1./lam.*(n5+n6*S+n7*T) + n8./lam.^2 + n9./lam.^3 ... + np.*P;  
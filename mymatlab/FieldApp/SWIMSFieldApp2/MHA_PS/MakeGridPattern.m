function [latp,lonp]=MakeGridPattern(lato,lono,dw,dl,npoints,theta,plotit,latmin,latmax,lonmin,lonmax);%function [latp,lonp=MakeGridPattern(lato,lono,dw,dl,npoints,theta,plotit,latmin,latmax,lonmin,lonmax);%Make lat,lon pairs for a grid pattern with cross-grid distance dw and distance between tracks of dl (in m),%(npoints) waypoints,and centered at lato and lono in decimal degrees (lon negative for west).%theta is the angle CCW in degrees to rotate the pattern.%plotit is 0 for no plot, 1 for a line plot of the shore, 2 for a grayscale depth contour.%If plotit==3 the waypoints will be overplotted on the current axes, without redrawing the topo contours.%latmin,latmax,lonmin,lonmax are the plot limits - it's unnecessary to specifiy these if not plotting.%If they are unspecified, defaults for South Whidbey bank are used.%4/02 MHA.%Typical values:%plotit=2;%tho=0;%dw=3000;%dl=750;%npoints=8;%lato=47.95;%lono=-122.55;latmid=lato;re=6.3767e+006;%Make the gridxs1(1:4:npoints)=0;xs1(2:4:npoints)=dw;xs1(3:4:npoints)=dw;xs1(4:4:npoints)=0;ys1=floor(((1:npoints)-1)/2)*dl;%theta=0;%25/180*pi;%Rotate the grid by the desired anglexp=xs1*cos(theta/180*pi)-ys1*sin(theta/180*pi);yp=xs1*sin(theta/180*pi)+ys1*cos(theta/180*pi);latp=lato+yp*360/2/pi/re;lonp=lono-xp*360/2/pi/re/cos(latmid/180*pi);%Now plot!if nargin <=7    latmin=47.7;    latmax=48;    lonmin=122.35;    lonmax=122.6;endif plotit==1    PSShorePlot(latmin,latmax,lonmin,lonmax);    hold on    h=plot(-lonp,latp,'r.');    h1=plot(-lonp,latp,'b-');    set(h,'MarkerSize',8)        hold offelseif plotit==2    PSBathyPlot(latmin,latmax,lonmin,lonmax);    hold on    h=plot(-lonp,latp,'r.');    h1=plot(-lonp,latp,'b-');    set(h,'MarkerSize',8)        hold offelseif plotit==3    %plot only waypoints in the current figure.    hold on    h=plot(-lonp,latp,'r.');    h1=plot(-lonp,latp,'b-');    set(h,'MarkerSize',8)        hold offenddxdist=diff(xp);dydist=diff(yp);ds=sqrt(dxdist.^2+dydist.^2);totdist=sum(ds);disp(['Total distance: ' num2str(totdist/1000) ' km'])
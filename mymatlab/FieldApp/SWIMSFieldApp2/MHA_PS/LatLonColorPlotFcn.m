function [ax1,ax2]=LatLonColorPlotFcn(latv,lonv,var,varmin,varmax,varstr,latmin,latmax,lonmin,lonmax)%function ax=LatLonColorPlotFcn(latmin,latmax,lonmin,lonmax,latv,lonv,var,varmin,varmax)%Pass in vectors of lat and lon and another variable of the same size,%and limits for all, and this routine will plot the variable in color at each%lat and lon specified, atop a map of Puget Sound with the specified limits.%handles to the axes are returned.  Varstr is a label for the color bar.%%MHA 3/29/01%Modified 4/22/02%%%ax1=PSShorePlot(latmin,latmax,lonmin,lonmax);ax1=PSBathyPlot(latmin,latmax,lonmin,lonmax);j=colormap;j=jet;colormap(j);ncolors=length(j);sk=1;hold on%plot(stmp,ttmp)tmin=varmin;tmax=varmax;lind=find(var>tmin & var < tmax);for ci=1:sk:length(lind)	h=plot(-lonv(lind(ci)),latv(lind(ci)),'k.');	set(h,'Markersize',8)	d=fix((var(lind(ci)) - tmin) / (tmax - tmin) * ncolors);	if d > ncolors, d=ncolors;end	if d < 1, d=1;end	set(h,'Color',j(d,:))	endhold offxlabel('lon');ylabel('lat');ax2=axes('position',[.88 .1 .02 .8]);image( [0 1], tmin +(0:(ncolors-1))*((tmax-tmin)/(ncolors-1)), (1:ncolors)' );axis xyset(ax2,'xticklabel',' ','xtick',[]);ylabel(varstr)
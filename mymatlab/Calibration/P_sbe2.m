function P=P_sbe2(pfreq,Tpr,Pcoef)%function P=P_sbe2(pfreq,Tpr,Pcoef)% Compute P = pressure [MPa], given:  pfreq = frequencies [Hz],%   Tpr = compensation temperatures [degC] (smoothed over 10s of seconds,%   preferably), and Pcoef = structure of pressure calibration coefficients.% apr-2002, DPW, revised from MHA 03/01 (adds T4,T5,D2)% jun-2015, DPW, return as dbar instead of MPaSTD_ATMOS=0.101325; % MPaC = Pcoef.C1 + Pcoef.C2*Tpr + Pcoef.C3*Tpr.^2;D = Pcoef.D1 + Pcoef.D2*Tpr;To = Pcoef.T1 + Pcoef.T2*Tpr + Pcoef.T3*Tpr.^2 + ...    Pcoef.T4*Tpr.^3 + Pcoef.T5*Tpr.^4;% Compute in psiaP = C.*(1 - (1e-6.*To.*pfreq).^2) .* (1 - D.*(1 - (1e-6.*To.*pfreq).^2));% Convert psia to MPaP = P * 6894.759/1e6;% Apply offset and slope corrections (mainly to re-zero on-deck pressure).P = P*Pcoef.mo + Pcoef.yo;% Finally, subtract off atmospheric, (2015:) convert to dbarP = (P - STD_ATMOS) * 100;
function C=C_sbe(cfreq,a,b,c,d,m,T,P, opt)%function C=C_sbe(cfreq,a,b,c,d,m,T,P, opt)%%3/01 MHA%Compute conductivity in S/m given cal coeffs a,b,c,d,m% and temperature T (degs C) and P (dbar).  [6/2015, use dbar - DPW]% dec/2010 - added option to allow for SBE4's GHIJ coeff's/formulaif nargin<9 || isempty(opt)   opt = 'abcdm';  % older method (default, bkwd compatable)endif ~ischar(opt)    opt='Not-a-string';endCPcor = -9.57e-8;CTcor = 3.25e-6;C = cfreq/1000; % kHzswitch lower(opt)    case 'abcdm'        C = (a*C.^m + b*C.^2 + c + d*T) ./ (10*(1+CPcor*P));    case 'ghij' % SBE's recommended        g=a; h=b; i=c; j=d;        C = (g+C.*C.*(h+C.*(i+j.*C))) ./ (10*(1+CTcor*T+CPcor*P));            otherwise        C = C*NaN;        warning(['unknown SBE Cond calib method: ' opt])end%remove negatives.C(find(C<0))=NaN;